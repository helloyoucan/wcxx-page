<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>新建工作方案</title>
		<link rel="stylesheet" href="../../vendor/bootstrap-3.3.7/css/bootstrap.min.css" />
		<link rel="stylesheet" href="../../css/public.css" />
		<link rel="stylesheet" href="../../vendor/jquery.my-message/css/jquery.my-message.1.1.css" />
		<link rel="stylesheet" href="../../css/newProject.css" />
	</head>

	<body>
		<div class="container-fluid setWidth new-project">
			<div class="form-table">
				<div class="ft-top">
					<h3 class="text-center">工作方案</h3>
					<p class="ft-t-state">
						状态&nbsp;:&nbsp;草稿
					</p>
				</div>
				<table class="table table-bordered">
					<tbody>
						<tr>
							<td>拟稿部门</td>
							<td></td>
							<td>拟稿时间</td>
							<td></td>
						</tr>
						<tr>
							<td>拟稿人</td>
							<td></td>
							<td>联系电话</td>
							<td></td>
						</tr>
						<tr>
							<td><span class="font-red">*</span>标题</td>
							<td colspan="3">
								<input type="text" class="form-control input-sm" />
							</td>
						</tr>
						<tr>
							<td><span class="font-red">*</span>方案类别</td>
							<td>
								<select class="form-control input-sm">
									<option>普通宣传活动</option>
								</select>
							</td>
							<td></td>
							<td></td>
						</tr>
						<tr>
							<td><span class="font-red">*</span>负责人</td>
							<td><input type="text" class="form-control input-sm" /></td>
							<td><span class="font-red">*</span>成员</td>
							<td><input type="text" class="form-control input-sm" /></td>
						</tr>
						<tr>
							<td><span class="font-red">*</span>预算（元）</td>
							<td><input type="text" class="form-control input-sm" /></td>
							<td><span class="font-red">*</span>实际费用（元）</td>
							<td><input type="text" class="form-control input-sm" /></td>
						</tr>
						<tr>
							<td><span class="font-red">*</span>执行时间</td>
							<td colspan="3" class="form-inline">
  								<div class="form-group">
									<input type="date" class="form-control input-sm" />
									至
									<input type="date" class="form-control input-sm" />
								</div>
							</td>
						</tr>
					</tbody>
				</table>
				<div class="data-table mid-table tab-table">
					<div class="mt-title">
						<ul class="nav nav-tabs" role="tablist">
							<li role="presentation" class="active">
								<a href="#main-body" aria-controls="main-body" role="tab" data-toggle="tab">正文</a>
							</li>
							<li role="presentation">
								<a href="#project" aria-controls="project" role="tab" data-toggle="tab">项目</a>
							</li>
						</ul>
					</div>
					<div class="tab-content">
						<div role="tabpanel" class="tab-pane active" id="main-body">
							<script id="editor" type="text/plain" style="width:100%;height:500px;"></script>
						</div>
						<div role="tabpanel" class="tab-pane" id="project">
							<div class="mt-handle-button-group">
								<button id="mt-btn-select" class="btn btn-default">选择</button>
								<button id="mt-btn-add" class="btn btn-default">添加</button>
								<button id="mt-btn-del" class="btn btn-default">删除</button>
							</div>
							<table class="table table-bordered checked-table">
								<thead>
									<tr>
										<th><input type="checkbox" /></th>
										<th>No.</th>
										<th>项目</th>
										<th>具体内容</th>
										<th>负责人</th>
										<th>要求完成时间</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td><input type="checkbox" /></td>
										<td>1</td>
										<td><input type="text" class="form-control input-sm" /></td>
										<td><input type="text" class="form-control input-sm" /></td>
										<td><input type="text" class="form-control input-sm" /></td>
										<td><input type="text" class="form-control input-sm" /></td>
									</tr>
									<script id="mt-tr" type="text/html">
										<tr>
											<td><input type="checkbox" /></td>
											<td>{{ index }}</td>
											<td><input type="text" class="form-control input-sm" /></td>
											<td><input type="text" class="form-control input-sm" /></td>
											<td><input type="text" class="form-control input-sm" /></td>
											<td><input type="text" class="form-control input-sm" /></td>
										</tr>
									</script>
								</tbody>
							</table>
						</div>
					</div>
				</div>
				<table class="table table-bordered">
					<tbody>
						<tr>
							<td>备注</td>
							<td colspan="3">
								<textarea class="form-control" rows="3"></textarea>
							</td>
						</tr>
						<tr>
							<td>附件</td>
							<td colspan="3">
								<div class="upload-file">
									<div class="uf-button">
										<button id="uf-btn-upload" class="btn btn-default"><span class="glyphicon glyphicon-plus"></span>添加</button>
										<form id="uf-form" method="post" action="/upload" target="uf-frame" encoding="multipart/form-data" enctype="multipart/form-data">
											<input id="uf-input-upload" type="file" />
										</form>
										<iframe id="uf-frame" name="uf-frame" src="" style="visibility:hidden;height: 0;border: 0;"></iframe>
									</div>
									<div class="uf-file-list" data-delUrl="url">
										<p>广州血液中心.doc
											<a href="javascript:;">[删除]</a>
										</p>
										<p>广州血液中心.doc
											<a href="javascript:;">[删除]</a>
										</p>
									</div>
								</div>
							</td>
						</tr>
						<tr>
							<td>领导审批意见</td>
							<td colspan="3"></td>
						</tr>
					</tbody>
				</table>

			</div>
			<div class="form-table-bottom">
				<div class="ft-b-left">
					<div class="ft-b-l-top">
						<form class="form-inline">
							<label class="checkbox-inline">选择常用意见&nbsp;:</label>
							<select name="" class="form-control">
								<option value="">--------------------------请选择----------------------------</option>
							</select>
						</form>
					</div>
					<div class="ft-b-l-bottom">
						<div class="ft-b-l-b-top">
							填写审批意见&nbsp;:
							<a href="javascript:;">添加为常用意见</a>
						</div>
						<textarea class="form-control" rows="3"></textarea>
					</div>

				</div>
				<div class="ft-b-right">
					<div class="ft-b-r-top">
						功能操作&nbsp;:
						<label class="checkbox-inline">
  							<input type="checkbox"value=""> 同步发送短信通知
						</label>
					</div>
					<div class="ft-b-r-bottom">
						<div class="ft-b-r-b-left">
							<button class="btn btn-primary"><span class="glyphicon glyphicon-pencil"></span>送科室领导</button>
							<button class="btn btn-primary"><span class="glyphicon glyphicon-pencil"></span>送部门领导</button>
							<br />
							<button class="btn btn-primary"><span class="glyphicon glyphicon-pencil"></span>送中心领导</button>
							<button class="btn btn-primary"><span class="glyphicon glyphicon-arrow-left"></span>退回拟稿人</button>
						</div>
						<div class="ft-b-r-b-right">
							<p>
								<a id="readFliwImg" href="javascript:;">查看流程图</a>
							</p>
							<p>
								<a href="javascript:;">查看流程跟踪</a>
							</p>

						</div>
					</div>
				</div>
			</div>
		</div>
		<!--模态框-->
		<div id="modal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
			<div class="modal-dialog modal-lg" role="document">
				<div class="modal-content">
					<div class="modal-body">
						<div class="container-fluid">
							<div class="handle-top">
								<form class="form-inline">
									<div class="form-group">
										<label>拟稿人:</label>
										<input type="text" class="form-control input-sm">
									</div>
									<div class="form-group">
										<label>标题:</label>
										<input type="text" class="form-control input-sm">
									</div>
									<div class="form-group">
										<label>拟稿时间:</label>
										<input type="text" class="form-control input-sm">
									</div>
									<button type="button" class="btn btn-default btn-sm">
										<span class="glyphicon glyphicon-search"></span>
										查询
									</button>
									<button type="button" class="btn btn-default btn-sm">
										<span class="glyphicon glyphicon-repeat"></span>
										重置
									</button>
								</form>
							</div>
							<div class="data-table">
								<table class="table table-bordered table-hover">
									<thead>
										<tr>
											<th>选择</th>
											<th>No.</th>
											<th>拟稿人</th>
											<th>拟稿时间</th>
											<th>标题</th>
										</tr>
									</thead>
									<tbody>
										<tr>
											<td><input type="radio" name="t-radio" data-id="1" /></td>
											<td>1</td>
											<td>test</td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td><input type="radio" name="t-radio" data-id="2" /></td>
											<td>2</td>
											<td></td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td><input type="radio" name="t-radio" data-id="3" /></td>
											<td>3</td>
											<td></td>
											<td></td>
											<td></td>
										</tr>
									</tbody>
								</table>
							</div>
							<div class="page">
								<ul class="pagination pagination-sm">
									<li class="disabled">
										<span href="#" aria-label="Previous">
											<span aria-hidden="true">&laquo;</span>
										</span>
									</li>
									<li class="active">
										<span href="#">1</span></li>
									<li>
										<span href="#">2</span></li>
									<li>
										<span href="#">3</span></li>
									<li>
										<span href="#">4</span></li>
									<li>
										<span href="#">5</span></li>
									<li>
										<span href="#" aria-label="Next">
											<span aria-hidden="true">&raquo;</span>
										</span>
									</li>
									<li class="li-page-handle">
										转到第
										<input type="text" class="form-control input-sm" /> 页
										<button type="button" class="btn btn-default btn-sm">
										GO
										</button>
									</li>
								</ul>
							</div>
						</div>
					</div>
					<div class="modal-footer">
						<button id="m-btn-sure" type="button" class="btn btn-primary">
							保存
						</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">
							关闭
						</button>
					</div>
				</div>
			</div>
		</div>
		<!--模态框end-->
		<script type="text/javascript" src="../../vendor/jquery1.9.min.js"></script>
		<script type="text/javascript" src="../../vendor/bootstrap-3.3.7/js/bootstrap.min.js"></script>
		<!--[if IE 8 ]>
			script type="text/javascript" src="../../vendor/es5-shim/es5-shim.min.js"></script>
			<script type="text/javascript" src="../../vendor/es5-shim/es5-sham.min.js"></script>
		 <![endif]-->
		<script type="text/javascript" src="../../vendor/template-web-min.js"></script>
		<script type="text/javascript" src="../../vendor/jquery.my-message/js/jquery.my-message.1.1.js"></script>
		<script type="text/javascript" src="../../js/public.js"></script>
		<script type="text/javascript" charset="utf-8" src="../../vendor/ueditor-1.4.3.3/dist/utf8-jsp/ueditor.config.js"></script>
		<script type="text/javascript" charset="utf-8" src="../../vendor/ueditor-1.4.3.3/dist/utf8-jsp/ueditor.all.min.js">
		</script>
		<!--建议手动加在语言，避免在ie下有时因为加载语言失败导致编辑器加载失败-->
		<!--这里加载的语言文件会覆盖你在配置项目里添加的语言类型，比如你在配置项目里配置的是英文，这里加载的中文，那最后就是中文-->
		<script type="text/javascript" charset="utf-8" src="../../vendor/ueditor-1.4.3.3/dist/utf8-jsp/lang/zh-cn/zh-cn.js"></script>
		<script>
			var winH = window.screen.height,
				winW = window.screen.width;
			$(".ft-b-r-b-left").on("click", "button", function() {
				window.open('../public/submitToDealWith.html', '提交办理', 'height=503, width=760, top=' + (winH - 503) / 2 + ', left=' + (winW - 760) / 2 + ', toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no')
			});
			//查看流程图
			$("#readFliwImg").on("click", function() {
				window.open('../public/flowImg.html', '查看流程图', 'height=525, width=840, top=' + (window.screen.height - 525) / 2 + ', left=' + (window.screen.width - 840) / 2 + ', toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no')
			});
			//中间的表格操作
			var $mid_table = $('.mid-table');
			//选择
			$mid_table.find('#mt-btn-select').on('click', function() {
				var $checkeds = $mid_table.find('tbody input[type="checkbox"]:checked');
				if(!$checkeds.length) {
					message.add("请先选择一条或多条数据", "warning");
				} else {
					$modal.modal('show');
				}
			});
			//模态框操作
			var $modal = $("#modal"),
				m_select_data = null;
			$modal.on('show.bs.modal', function(e) {
				m_select_data = null;
				$modal.find('.table').find('input[type="radio"]').attr("checked", false);
			})

			//模态框中的确定按钮
			$modal.find("#m-btn-sure").on('click', function() {
				var $radioChecked = $modal.find('.table').find('input[type="radio"]:checked');
				if($radioChecked.length) { //模态框的表格中有选中的
					console.log($radioChecked.attr('data-id'));
					var data_id = $radioChecked.attr('data-id');
					var $checkeds = $mid_table.find('tbody input[type="checkbox"]:checked');
					$checkeds.each(function(index, Element) {
						var $tds = $(this).parents('tr').find('input');
						//code
						$tds.eq(1).val(data_id);
						$tds.eq(2).val(data_id);
						$tds.eq(3).val(data_id);
						$tds.eq(4).val(data_id);
					});
					$modal.modal('hide');
				} else {
					message.add("请先选择数据", "error");
				}
			});
			//获取表格中数据的条数
			mid_table_action('mt-tr', 'tbody', 'tr', function() {
				//添加时返回序号
				return $('.checked-table tr').length;
			}, function() {
				var $tr = $('.checked-table tr');
				$tr.each(function(index) {
					//删除时重新添加序号
					$(this).children('td').eq(1).text(index);
				});
			});
			//初始化富文本框
			var ue = UE.getEditor('editor');
			//获取html
			//UE.getEditor('editor').getAllHtml()
		</script>
	</body>

</html>